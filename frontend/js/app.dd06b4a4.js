(function(e){function t(t){for(var n,c,u=t[0],s=t[1],i=t[2],p=0,f=[];p<u.length;p++)c=u[p],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&f.push(a[c][0]),a[c]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);l&&l(t);while(f.length)f.shift()();return o.push.apply(o,i||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,u=1;u<r.length;u++){var s=r[u];0!==a[s]&&(n=!1)}n&&(o.splice(t--,1),e=c(c.s=r[0]))}return e}var n={},a={app:0},o=[];function c(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=e,c.c=n,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(r,n,function(t){return e[t]}.bind(null,n));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var i=0;i<u.length;i++)t(u[i]);var l=s;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},1877:function(e,t,r){},"4fdc":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("7a23");function a(e,t,r,a,o,c){var u=Object(n["t"])("router-view");return Object(n["n"])(),Object(n["c"])(u)}var o={};r("9118");o.render=a;var c=o,u=(r("b0c0"),r("96cf"),r("1da1")),s=r("6c02"),i=Object(n["B"])("data-v-f2845de2");Object(n["q"])("data-v-f2845de2");var l={class:"cont"},p=Object(n["e"])("h1",null,"Авторизация",-1),f={class:"from"},d=Object(n["e"])("label",{for:"inputLogin"},"Логин или email: ",-1),b=Object(n["e"])("label",{for:"inputPassword"},"Пароль: ",-1);Object(n["o"])();var m=i((function(e,t,r,a,o,c){return Object(n["n"])(),Object(n["c"])("div",l,[p,Object(n["e"])("form",f,[Object(n["e"])("p",{class:["errorMessag",e.error?"active":""]}," Не верный логин или пароль ",2),d,Object(n["z"])(Object(n["e"])("input",{class:"field",type:"text",name:"login",id:"inputLogin",placeholder:"Введите логин или пароль","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.username=t})},null,512),[[n["x"],e.username]]),b,Object(n["z"])(Object(n["e"])("input",{class:"field",type:"password",name:"password",id:"inputPassword",placeholder:"Введите пароль","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.password=t})},null,512),[[n["x"],e.password]]),Object(n["e"])("button",{type:"submit",class:c.validForm?"":"disabled",disabled:!c.validForm,onClick:t[3]||(t[3]=Object(n["A"])((function(){return c.toAuth&&c.toAuth.apply(c,arguments)}),["prevent"]))}," Войти ",10,["disabled"])])])})),h=r("5530"),v=r("5502"),O={data:function(){return{username:"",password:"",save:!0,error:!1}},components:{},methods:Object(h["a"])(Object(h["a"])({},Object(v["b"])({auth:"user/auth"})),{},{toAuth:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.auth({username:e.username,password:e.password});case 2:r=t.sent,!r&&(e.error=!0),console.log(e.error);case 5:case"end":return t.stop()}}),t)})))()}}),computed:{validForm:function(){return""!==this.username&&""!==this.password}}};r("a10e");O.render=m,O.__scopeId="data-v-f2845de2";var j=O,g={action:""},w=Object(n["e"])("span",null,"Load file",-1),y=Object(n["e"])("span",null,"Import",-1),k={key:2},x={key:3,class:"err"},F={key:4,class:"message",id:"import_message"};function R(e,t,r,a,o,c){return Object(n["n"])(),Object(n["c"])("form",g,[Object(n["e"])("input",{type:"file",name:"file",class:"csv-file",onChange:t[1]||(t[1]=function(e){return c.getFile(e)})},null,32),!e.file||e.error?(Object(n["n"])(),Object(n["c"])("div",{key:0,class:"addFile",onClick:t[2]||(t[2]=Object(n["A"])((function(t){return e.$el.querySelector("input").click()}),["prevent"]))},[w])):Object(n["d"])("",!0),e.file&&!e.error?(Object(n["n"])(),Object(n["c"])("div",{key:1,class:"importFile",onClick:t[3]||(t[3]=Object(n["A"])((function(){return c.importFile&&c.importFile.apply(c,arguments)}),["prevent"]))},[y])):Object(n["d"])("",!0),e.file?(Object(n["n"])(),Object(n["c"])("small",k,Object(n["v"])(e.file),1)):Object(n["d"])("",!0),e.error?(Object(n["n"])(),Object(n["c"])("p",x,Object(n["v"])(e.error),1)):Object(n["d"])("",!0),e.message?(Object(n["n"])(),Object(n["c"])("p",F," Фаил был успешно загружен! ")):Object(n["d"])("",!0)])}r("caad"),r("2532"),r("4160"),r("b64b"),r("d3b7"),r("159b");var _=r("53ca"),P=r("d4ec"),U=r("bee2"),S=function(){function e(t,r){Object(P["a"])(this,e),this.baseURL=t,this.options=r}return Object(U["a"])(e,[{key:"_creatFromData",value:function(e){var t=new FormData;if("array"===typeof e&&e.forEach((function(e){return t.append(Object.keys(e)[0],e)})),"object"===Object(_["a"])(e))for(var r in e)if(Object.hasOwnProperty.call(e,r)){var n=e[r];t.append(r,n)}return t}},{key:"_request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.baseURL+e;return fetch(r,t?Object(h["a"])(Object(h["a"])({},this.options),t):this.options).then((function(e){if(200===e.status)return e.json();throw new Error("Server's answer isn't correct...")})).catch((function(e){return console.error(e)}))}},{key:"get",value:function(e){var t={method:"GET"};return this._request(e,t)}},{key:"delete",value:function(e){var t={method:"DELETE"};return this._request(e,t)}},{key:"post",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=r?this._creatFromData(t):t,a={method:"POST",body:n instanceof FormData?n:JSON.stringify(t),headers:n instanceof FormData?{}:{"Content-Type":"application/json"}};return this._request(e,a)}},{key:"put",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=r?this._creatFromData(t):t,a={method:"PUT",body:n instanceof FormData?n:JSON.stringify(t),headers:n instanceof FormData?{}:{"Content-Type":"application/json"}};return this._request(e,a)}}]),e}(),A=new S("/",{}),D=A,T=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,D.post("add/objects",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q={data:function(){return{file:null,error:null,message:null}},methods:{getFile:function(e){this.error=null,this.file=e.target.value,!this.file.includes(".csv")&&(this.error="Вы загружает фаил неверного формата")},importFile:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T(new FormData(e.$el));case 3:r=t.sent,n=r.res,n?(e.file=null,e.$el.reset(),e.message=!0,setTimeout((function(){e.message=!1}),5e3)):(e.error="Ошибка ответа от сервера, возможно вашь файл имеет неверную структуру",e.$el.reset()),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}},computed:{fileName:function(){return console.log(this.file),file()}}};r("6d88");q.render=R;var E,C=q,I=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,D.post("auth",t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,D.get("auth/".concat(t),I);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=new Promise((function(e){E=e})),J={namespaced:!0,state:{user:null},getters:{user:function(e){return e.user},ready:function(){return M}},mutations:{setUser:function(e,t){e.user=t}},actions:{auth:function(e,t){return Object(u["a"])(regeneratorRuntime.mark((function r(){var n,a,o,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=e.commit,r.prev=1,r.next=4,I(t);case 4:a=r.sent,o=a.user,a.result,c=a.token,c&&(localStorage.setItem("token",c),n("setUser",Object(h["a"])(Object(h["a"])({},o),{},{token:c})),V.push("/import")),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](1),console.log(r.t0);case 14:case"end":return r.stop()}}),r,null,[[1,11]])})))()},getUser:function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var r,n,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.commit,t.prev=1,n=localStorage.getItem("token"),!n){t.next=11;break}return t.next=6,L(n);case 6:a=t.sent,o=a.username,r("setUser",o||null),t.next=12;break;case 11:r("setUser",null);case 12:E(),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](1),console.log(t.t0);case 18:case"end":return t.stop()}}),t,null,[[1,15]])})))()},setUser:function(e,t){var r=e.commit;r("setUser",t)}}},$=Object(v["a"])({state:{},mutations:{},actions:{},modules:{user:J}}),N=[{path:"/",name:"Auth",component:j},{path:"/import",name:"Import",component:C}],z=Object(s["a"])({history:Object(s["b"])("/"),mode:history,routes:N});z.beforeEach(function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,r,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$.getters["user/ready"];case 2:console.log($.getters),$.getters["user/user"]||"Auth"===t.name?$.getters["user/user"]&&"Auth"===t.name?n({name:"Import"}):n():n({name:"Auth"});case 4:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}());var V=z;$.dispatch("user/getUser"),Object(n["b"])(c).use($).use(V).mount("#app")},"6d88":function(e,t,r){"use strict";r("1877")},9118:function(e,t,r){"use strict";r("4fdc")},9719:function(e,t,r){},a10e:function(e,t,r){"use strict";r("9719")}});
//# sourceMappingURL=app.dd06b4a4.js.map